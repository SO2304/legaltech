# Script de deploiement Render.com
# Usage: .\deploy-render.ps1

$apiKey = "rnd_1ZYZvILGTAVanCuP521vCuVLARya"
$repoUrl = "https://github.com/SO2304/legaltech"
$branch = "main"

Write-Host "Deploiement Divorce Platform sur Render.com" -ForegroundColor Green
Write-Host "Cle API: $($apiKey.Substring(0,10))..."
Write-Host "Repo: $repoUrl"
Write-Host "Branch: $branch"
Write-Host ""

Write-Host "INSTRUCTIONS DE DEPLOIEMENT:" -ForegroundColor Yellow
Write-Host ""
Write-Host "1. Allez sur https://dashboard.render.com"
Write-Host ""
Write-Host "2. Connectez votre compte GitHub (si pas deja fait)"
Write-Host ""
Write-Host "3. Cliquez sur 'New +' puis 'Web Service'"
Write-Host ""
Write-Host "4. Selectionnez le repo: SO2304/legaltech"
Write-Host ""
Write-Host "5. Configurez comme suit:"
Write-Host "   - Name: divorce-platform"
Write-Host "   - Runtime: Node"
Write-Host "   - Region: Frankfurt"
Write-Host "   - Plan: Starter"
Write-Host "   - Build Command: npm install && npx prisma generate && npm run build"
Write-Host "   - Start Command: npm start"
Write-Host "   - Health Check: /api/health"
Write-Host ""
Write-Host "6. Ajoutez les variables d'environnement (depuis .env.example):"
Write-Host "   DATABASE_URL, DIRECT_DATABASE_URL, ANTHROPIC_API_KEY"
Write-Host "   STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET"
Write-Host "   SUPABASE_URL, SUPABASE_SERVICE_KEY, SUPABASE_ANON_KEY"
Write-Host "   CRON_SECRET, RESEND_API_KEY"
Write-Host ""
Write-Host "7. Cliquez sur 'Create Web Service'"
Write-Host ""
Write-Host "8. Render lira render.yaml et creera automatiquement:"
Write-Host "   - Web service principal"
Write-Host "   - Cron job RGPD (0 2 * * *)"
Write-Host ""
Write-Host "9. Configurez les webhooks Stripe dans le dashboard Stripe:"
Write-Host "   URL: https://divorce-platform.onrender.com/api/webhook/stripe"
Write-Host ""
Write-Host "Succes! Le service se redepliera automatiquement a chaque push sur main"
